<app-top-bar-admin></app-top-bar-admin>
<form class="form-inline" [formGroup]="bookForm" (submit)="searchUsers()">
    <section class="col-lg-3 col-md-6 form-group mr-2">
        <label for="alumn" class="sr-only">Alumno</label>
        Nombre:<input type="text" formControlName="name" class="form-control" id="alumn" placeholder="Ej: Jose">
    </section>
    <section class="col-lg-3 col-md-6 form-group mr-2">
        Desde: <input type="date" class="form-control" formControlName="dateFrom" id="from" placeholder="05/11/2019">
    </section>
    <section class="col-lg-3 col-md-6 form-group mr-2">
        Hasta: <input type="date" class="form-control" formControlName="dateTo" id="to" placeholder="09/11/2019">
    </section>
    <section class="col-lg-2 col-md-6 form-group mr-2">
        Estado: <select id="status" formControlName="status" class="form-control">
            <option></option>
            <option>Devuelto</option>
            <option>Falta</option>
            <option>Prestado</option>
            <option>Solicitado</option>
        </select>
    </section>
    <input type="submit" value="Buscar" class="search btn btn-outline-primary">
    <input type="reset" value="Limpiar" class="search btn btn-outline-primary">
    <input type="button" (click)="convertToPDF()" value="PDF" class="search btn btn-outline-danger">
</form>
<h3 class="mx-2 mt-2 px-3 text-muted text text-center">Libros en circulación</h3>
<div *ngIf="bookService.booksClone!=[]">
    <div class="box">
        <div *ngFor="let book of bookService.booksClone">
            <div ngSwitch={{book.STATUS_BOOK}}>
                <div *ngSwitchCase="'FALTA'">
                    <div class="alert alert-danger" role="alert">
                        <article>Estudiante:<b>
                                {{book.SURNAMES+
                                ", "+
                                book.NAME}}</b>
                        </article>
                        <article>ISBN: {{book.ISBN}}</article>
                        <article>Título: <b>{{book.TITLE}}</b>
                        </article>
                        <article>Editorial:
                            {{book.PUBLISHING_HOUSE.substr(0,1)+book.PUBLISHING_HOUSE.substr(1,book.PUBLISHING_HOUSE.length).toLowerCase()}}
                        </article>
                        <article>Tema: {{book.TOPIC.substr(0,1)+book.TOPIC.substr(1,book.TOPIC.length).toLowerCase()}}
                        </article>
                        <article>Fecha de solicitud:
                            {{book.REQUEST_DATE!=null?book.REQUEST_DATE.split("-").join("/"):"----/--/--"}}</article>
                        <article>Fecha de prestamo:
                            {{book.BORROW_DATE!=null?book.BORROW_DATE.split("-").join("/"):"----/--/--"}}</article>
                        <article>Fecha de devolución: ----/--/--</article>
                        <article>Estado:
                            {{book.STATUS_BOOK.substr(0,1)+book.STATUS_BOOK.substr(1,book.STATUS_BOOK.length).toLowerCase()}}
                        </article>
                    </div>
                </div>
                <div *ngSwitchCase="'DEVUELTO'">
                    <div class="alert alert-success" role="alert">
                        <article>Estudiante:<b>
                                {{book.SURNAMES+
                                " , "+
                                book.NAME}}</b>
                        </article>
                        <article>ISBN: {{book.ISBN}}</article>
                        <article>Título: <b>{{book.TITLE}}</b>
                        </article>
                        <article>Editorial:
                            {{book.PUBLISHING_HOUSE.substr(0,1)+book.PUBLISHING_HOUSE.substr(1,book.PUBLISHING_HOUSE.length).toLowerCase()}}
                        </article>
                        <article>Tema: {{book.TOPIC.substr(0,1)+book.TOPIC.substr(1,book.TOPIC.length).toLowerCase()}}
                        </article>
                        <article>Fecha de solicitud:
                            {{book.REQUEST_DATE!=null?book.REQUEST_DATE.split("-").join("/"):"----/--/--"}}</article>
                        <article>Fecha de prestamo:
                            {{book.BORROW_DATE!=null?book.BORROW_DATE.split("-").join("/"):"----/--/--"}}</article>
                        <article>Fecha de devolución:
                            {{book.RETURN_DATE!=null?book.RETURN_DATE.split("-").join("/"):"----/--/--"}}</article>
                        <article>Estado:
                            {{book.STATUS_BOOK.substr(0,1)+book.STATUS_BOOK.substr(1,book.STATUS_BOOK.length).toLowerCase()}}
                        </article>
                    </div>
                </div>
                <div *ngSwitchCase="'PRESTADO'">
                    <div class="alert alert-warning" role="alert">
                        <article>Estudiante:<b>
                                {{book.SURNAMES+
                                ", "+
                                book.NAME}}</b>
                        </article>
                        <article>ISBN: {{book.ISBN}}</article>
                        <article>Título: <b>{{book.TITLE}}</b>
                        </article>
                        <article>Editorial:
                            {{book.PUBLISHING_HOUSE.substr(0,1)+book.PUBLISHING_HOUSE.substr(1,book.PUBLISHING_HOUSE.length).toLowerCase()}}
                        </article>
                        <article>Tema: {{book.TOPIC.substr(0,1)+book.TOPIC.substr(1,book.TOPIC.length).toLowerCase()}}
                        </article>
                        <article>Fecha de solicitud:
                            {{book.REQUEST_DATE!=null?book.REQUEST_DATE.split("-").join("/"):"----/--/--"}}</article>
                        <article>Fecha de prestamo:
                            {{book.BORROW_DATE!=null?book.BORROW_DATE.split("-").join("/"):"----/--/--"}}</article>
                        <article>Fecha de devolución: ----/--/--</article>
                        <article>Estado:
                            {{book.STATUS_BOOK.substr(0,1)+book.STATUS_BOOK.substr(1,book.STATUS_BOOK.length).toLowerCase()}}
                        </article>
                        <article>
                            <button type="button" class="btn btn-warning"
                                (click)="returnBook(book.ISBN,book.ID_USER)">Devolver</button>
                        </article>
                    </div>
                </div>
                <div *ngSwitchDefault>
                    <div class="alert alert-primary" role="alert">
                        <article>Estudiante:<b>
                                {{book.SURNAMES+
                                " , "+
                                book.NAME}}</b>
                        </article>
                        <article>ISBN: {{book.ISBN}}</article>
                        <article>Título: <b>{{book.TITLE}}</b>
                        </article>
                        <article>Editorial:
                            {{book.PUBLISHING_HOUSE.substr(0,1)+book.PUBLISHING_HOUSE.substr(1,book.PUBLISHING_HOUSE.length).toLowerCase()}}
                        </article>
                        <article>Tema: {{book.TOPIC.substr(0,1)+book.TOPIC.substr(1,book.TOPIC.length).toLowerCase()}}
                        </article>
                        <article>Fecha de solicitud:
                            {{book.REQUEST_DATE!=null?book.REQUEST_DATE.split("-").join("/"):"----/--/--"}}</article>
                        <article>Estado:
                            {{book.STATUS_BOOK.substr(0,1)+book.STATUS_BOOK.substr(1,book.STATUS_BOOK.length).toLowerCase()}}
                        </article>
                        <article>
                            <button type="button" class="btn btn-primary"
                                (click)="giveBook(book.ISBN,book.ID_USER)">Prestar</button>
                        </article>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div *ngIf="userService.books.length==0">
    <h2 class="text-center font-italic py-5">No hay libros disponibles</h2>
</div>
<div *ngIf="userService.books!=[]">
    <h3 class="mx-2 mt-2 px-3 text-muted text text-center">Libros disponibles</h3>
    <div class="box">
        <div *ngFor="let books of userService.books">
            <div class="alert alert-dark">
                <article>ISBN: <b>{{books.ISBN}}</b></article>
                <article>Título:
                    <i>{{books.TITLE}}</i>
                </article>
                <article>Asignatura:
                    <i>{{books.SUBJECT}}</i>
                </article>
                <article>Autor:
                    <i>{{books.AUTHOR}}</i>
                </article>
                <article>Stock:
                    <b>{{books.STOCK}}</b>
                </article>
            </div>
        </div>
    </div>
</div>